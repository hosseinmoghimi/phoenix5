<script>
    let sub_projects_service_requests = JSON.parse(`{{sub_projects_service_requests_s|escapejs}}`)




    let sub_projects_service_requests_app = new Vue({
        el: "#sub-projects-service-requests-app",
        data: {


            sub_projects_service_requests: sub_projects_service_requests,
            waiting: false,
            sum_service_requests: 0,

            filter_status: "",

        },
        mounted: function () {
            this.sum_service_requests = 0
            this.sub_projects_service_requests.forEach(service_request => {
                this.sum_service_requests += service_request.total

                this.count_service_requests += service_request.quantity
            });
        },
        methods: {
            to_price: function (value, CURRENCY) {
                return to_price(value, CURRENCY)
            },
            filter: function () {
                this.service_requests = service_requests

                if (this.filter_status != "") {
                    this.service_requests = this.service_requests.filter(item => item.status === service_requests_app.filter_status)
                }
            },

            filter_list: function () {
                if (this.add_service_request_form_title) {

                    this.services = all_services.filter((item) => { return item.full_title.toUpperCase().indexOf(this.add_service_request_form_title.toUpperCase()) > -1 }).slice(0, 6);
                    try {
                        this.add_service_request_form_unit_price = this.selected_service().unit_price
                        this.add_service_request_form_unit_name = this.selected_service().unit_name
                    } catch (error) {

                    }
                }

            }
        }
    })
</script>