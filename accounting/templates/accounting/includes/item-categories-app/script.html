<script>
    let all_item_categories = JSON.parse("{{all_categories_s|escapejs}}").sort((a, b) => { a.full_title < b.full_title })

    let item_categories_app = new Vue({
        el: "#item-categories-app",
        data: {
            item_categories: JSON.parse("{{item_categories_s|escapejs}}"),
            waiting: false,
            all_categories: all_item_categories,
            edit: false,
            category_id: "",
        },
        methods: {
            add_item_category: function () {
                item_categories_app.waiting = true
                let payload = {
                    csrfmiddlewaretoken: csrfmiddlewaretoken,
                    category_id: parseInt(this.category_id),
                    product_or_service_id: parseInt("{{product_or_service.pk}}"),
                }
                let url = "{% url 'accounting:add_item_category' %}"
                console.log(payload)
                $.post(url, payload).done((data) => {
                    item_categories_app.edit = false
                    item_categories_app.waiting = false
                    console.log(data)
                    if (data.result === 'SUCCEED') {

                        item_categories_app.item_categories = data.item_categories
                    }
                })
            }
        }
    })
</script>