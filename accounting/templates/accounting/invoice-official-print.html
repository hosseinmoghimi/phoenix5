{% extends "accounting/wide-layout.html" %}

{% load to_persian_date %}

{% load to_variz_text %}
{% block content %}
<div class="row">
    <div class="col-md-12">

        <div class="card">
            <div class="card-body">
                <h4 class="text-center">
                    صورتحساب فروش کالا و خدمات


                </h4>
                <h6 class="text-left mx-5">شماره فاکتور :
                    <span>{{invoice.pk}}</span>
                </h6>

                <h6 class="text-left mx-5">تاریخ :
                    <span>{{invoice.transaction_datetime|to_persian_date|safe}}</span>
                </h6>

                <div class="card">
                    <div class="card-header">
                        <h6 class="text-center">

                            مشخصات فروشنده
                        </h6>

                    </div>
                    <div class="card-body">
                        <div class="row">
                            {% if invoice.pay_from.title %}
                            <div class="col-md-4">
                                <div class="farsi text-right">
                                    نام تجاری :
                                    {{invoice.pay_from.title}}
                                </div>
                            </div>
                            {% endif %}

                            {% if invoice.pay_from.economic_no %}
                            <div class="col-md-4">
                                <div class=" farsi text-right">
                                    شماره اقتصادی :
                                    {{invoice.pay_from.economic_no}}
                                </div>
                            </div>
                            {% endif %}
                            {% if invoice.pay_from.melli_id %}
                            <div class="col-md-4">

                                <div class=" farsi text-right">
                                    شناسه ملی :
                                    {{invoice.pay_from.melli_id}}
                                </div>
                            </div>
                            {% endif %}


                            {% if invoice.pay_from.address %}
                            <div class="col-md-4">

                                <div class=" farsi text-right">
                                    آدرس :
                                    {{invoice.pay_from.address}}
                                </div>
                            </div>
                            {% endif %}
                            {% if invoice.pay_from.tel %}
                            <div class="col-md-4">
                                <div class=" farsi text-right">
                                    تلفن :
                                    {{invoice.pay_from.tel}}
                                </div>
                            </div>
                            {% endif %}
                            {% if invoice.pay_from.melli_id %}
                            <div class="col-md-4">

                                <div class="farsi text-right">
                                    کد پستی :
                                    {{invoice.pay_from.postal_code}}
                                </div>
                            </div>
                            {% endif %}
                        </div>
                    </div>
                </div>



                <div class="card">
                    <div class="card-header">
                        <h6 class="text-center">

                            مشخصات خریدار
                        </h6>

                    </div>
                    <div class="card-body">
                        <div class="row">
                            {% if invoice.pay_to.title %}
                            <div class="col-md-4">
                                <div class="farsi text-right">
                                    نام تجاری :
                                    {{invoice.pay_to.title}}
                                </div>
                            </div>
                            {% endif %}

                            {% if invoice.pay_to.economic_no %}
                            <div class="col-md-4">
                                <div class=" farsi text-right">
                                    شماره اقتصادی :
                                    {{invoice.pay_to.economic_no}}
                                </div>
                            </div>
                            {% endif %}
                            {% if invoice.pay_to.melli_id %}
                            <div class="col-md-4">

                                <div class=" farsi text-right">
                                    شناسه ملی :
                                    {{invoice.pay_to.melli_id}}
                                </div>
                            </div>
                            {% endif %}


                            {% if invoice.pay_to.address %}
                            <div class="col-md-4">

                                <div class=" farsi text-right">
                                    آدرس
                                    :
                                    {{invoice.pay_to.address}}
                                </div>
                            </div>
                            {% endif %}
                            {% if invoice.pay_to.tel %}
                            <div class="col-md-4">
                                <div class=" farsi text-right">
                                    تلفن :
                                    {{invoice.pay_to.tel}}
                                </div>
                            </div>
                            {% endif %}
                            {% if invoice.pay_to.melli_id %}
                            <div class="col-md-4">

                                <div class="farsi text-right">
                                    کد پستی :
                                    {{invoice.pay_to.postal_code}}
                                </div>
                            </div>
                            {% endif %}
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="col-md-12">
        {% load to_price %}

        <div class="card" id="invoice-lines-app">
            <div class="card-header">
                <h6 class="text-center">
                    شرح کالا و خدمات
                </h6>
            </div>
            <div class="card-body">
                <div class="table-responsive">

                    <table class="table table-striped">
                        <thead>
                            <th class="bordered">
                                ردیف
                            </th>

                            <th class="bordered">
                                شرح
                            </th>
                            <th class="bordered">
                                تعداد
                            </th>

                            <th class="bordered">
                                فی
                                <small class="text-muted">

                                    (&nbsp;{{CURRENCY}}&nbsp;)
                                </small>
                            </th>

                            <th class="bordered">
                                جمع
                                <small class="text-muted">

                                    (&nbsp;{{CURRENCY}}&nbsp;)
                                </small>
                            </th>

                            <th class="bordered">
                                تخفیف
                                <small class="text-muted">

                                    (&nbsp;{{CURRENCY}}&nbsp;)
                                </small>
                            </th>

                            <th class="bordered">
                                مبلغ کل پس از تخفیف
                                <small class="text-muted">

                                    (&nbsp;{{CURRENCY}}&nbsp;)
                                </small>
                            </th>



                            <th class="bordered">
                                مالیات و عوارض
                                <small class="text-muted">

                                    (&nbsp;{{CURRENCY}}&nbsp;)
                                </small>
                            </th>


                            <th class="bordered">
                                مبلغ قابل پرداخت
                                <small class="text-muted">

                                    (&nbsp;{{CURRENCY}}&nbsp;)
                                </small>
                            </th>




                        </thead>
                        <tbody>
                            <tr v-for="invoice_line in invoice_lines">
                                <td class="bordered">
                                    <span v-text="invoice_line.row"></span>
                                </td>

                                <td class="bordered">
                                    <span v-text="invoice_line.product_or_service.title"></span>
                                </td>


                                <td class="bordered">
                                    <span v-text="invoice_line.quantity"></span>
                                    <span v-text="invoice_line.unit_name"></span>
                                </td>

                                <td class="bordered">
                                    <span v-text="to_price(invoice_line.unit_price)"></span>
                                </td>

                                <td class="bordered">
                                    <span v-text="to_price(invoice_line.unit_price*invoice_line.quantity)"></span>
                                </td>



                                <td class="bordered">
                                    0
                                </td>


                                <td class="bordered">
                                    <span v-text="to_price(invoice_line.unit_price*invoice_line.quantity)"></span>
                                </td>



                                <td class="bordered">
                                    <span
                                        v-text="to_price(tax_percent*invoice_line.unit_price*invoice_line.quantity/100)"></span>
                                </td>



                                <td class="bordered">
                                    <span
                                        v-text="to_price((100+tax_percent)*invoice_line.unit_price*invoice_line.quantity/100)"></span>
                                </td>

                            </tr>



                            <tr>
                                <td class="bordered">

                                </td>

                                <td class="bordered">


                                </td>


                                <td class="bordered">
                                    <!-- <span v-text="invoice_line.quantity"></span>
                                    <span v-text="invoice_line.unit_name"></span> -->
                                </td>

                                <td class="bordered">
                                    <!-- <span v-text="to_price(invoice_line.unit_price)"></span> -->
                                </td>

                                <td class="bordered">
                                    <!-- <span v-text="to_price(invoice_line.unit_price*invoice_line.quantity)"></span> -->
                                    {{invoice.lines_total|to_price_rial}}

                                </td>



                                <td class="bordered">
                                    0
                                </td>


                                <td class="bordered">
                                    {{invoice.lines_total|to_price_rial}}
                                    <!-- <span v-text="to_price(invoice_line.unit_price*invoice_line.quantity)"></span> -->
                                </td>



                                <td class="bordered">
                                    <span v-text="to_price({{invoice.tax_amount}})">
                                    </span> {{CURRENCY}}
                                </td>



                                <td class="bordered">
                                    {{invoice.sum_total|to_price_rial}}
                                    </span>

                                </td>

                            </tr>



                            <tr>
                                <td colspan="8">

                                    <div class="text-left">


                                        <span class="h5">
                                            {{invoice.sum_total|to_horuf_rial}} ریال
                                        </span>
                                    </div>
                                    <div class="text-left">


                                        <span class="h6">
                                            {{invoice.sum_total|to_horuf}} تومان
                                        </span>
                                    </div>

                                </td>

                                <td class="bordered ">
                                    <h5>
                                        {{invoice.sum_total|to_price_rial}}
                                    </h5>
                                    <h6>
                                        {{invoice.sum_total|to_price}}
                                    </h6>
                                </td>

                            </tr>
                        </tbody>
                    </table>
                </div>

            </div>
        </div>
    </div>
    <div class="col-md-12">

        <div class="card">
            <div class="card-header">
                <h6 class="text-center">
                    توضیحات ، شرایط و نحوه فروش
                </h6>
            </div>
            <div class="card-body px-5 farsi text-right">

                <div>
                    واحد مبلغ ها
                    {{CURRENCY}}
                    می باشد.
                </div>
                {% if invoice.pay_from and invoice.pay_from.default_bank_account %}
                <div>
                    {{invoice.pay_from.default_bank_account|to_variz_text}}
                </div>
                {% endif %}
                <div class="text-right farsi">
                    {{invoice.status}}
                    /
                    {{invoice.payment_method}}
                </div>
                {% if invoice.description %}
                <div class=" ">
                    {{invoice.description|safe}}
                </div>
                {% endif %}
            </div>
        </div>

    </div>
    <div class="col-md-12">
        <div class="row">
            <div class="col-md-6">
                <div class="card">
                    <div class="card-body">


                        <p class="text-center">
                            خریدار : {{invoice.pay_to.title}}
                        </p>



                        <div class="mb-5">&nbsp;</div>

                    </div>
                </div>
            </div>

            <div class="col-md-6">
                <div class="card">
                    <div class="card-body">



                        <p class="text-center">
                            فروشنده : {{invoice.pay_from.title}}
                        </p>



                        <div class="mb-5">&nbsp;</div>
                    </div>
                </div>
            </div>

        </div>

    </div>



</div>

{% endblock content %}


{% block script %}
<script>
    let page_id = parseInt("{{page.id}}")
    let invoice_lines = JSON.parse(`{{invoice_lines_s|escapejs}}`)
</script>
{% include "accounting/includes/invoice-lines-app/script.html" %}

{% endblock script %}